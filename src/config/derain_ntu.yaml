# Configuration for NTU Derain Video Training
# Usage: python train_video5.py --config src/config/derain_ntu.yaml

# ============ Data ============
data_root: /home/exp/dataset/train/derain
val_root: /home/exp/dataset/test/derain
input_dirname: rainy
target_dirname: gt

# Temporal settings
T: 5
stride: 1
pad_mode: replicate
stack_dim: TC
crop_size: 256

# ============ Model ============
embed_dim: 128
depth: 12
heads: 8
mlp_ratio: 4.0
patch: 8

# ============ Rotation (Lie Group) ============
so3_mode: so2
angle_max_deg: 35.0
so3_stochastic: 0
angle_reg: 0.001 

# Temporal time bias
time_weight: 0.5
time_kappa: 1.0

w_lievel: 0.01
lievel_smooth: 0.5

# ============ Training ============
batch_size: 8
epochs: 8000 
lr: 0.0002  # 2e-4
workers: 16
amp: 1

warmup_epochs: 10     
grad_clip: 0.5        

w_l1: 0.0         
w_l2: 0.0
w_charb: 1.0           
w_edge: 0.05        
w_ssim: 0.05        
w_fft: 0.05          

# ============ Logging ============
save_dir: /home/exp/lie-transformer-camera/runs_NTU_video_V3
vis_every: 1000
val_vis_n: 1
vis_compare_no_rot: 0

# ============ Multi-GPU ============
gpus: "1,2,3,5,7"
use_ddp: 1

use_ema: 1            
ema_decay: 0.999    
